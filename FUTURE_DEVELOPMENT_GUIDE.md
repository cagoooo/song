# ğŸš€ äº’å‹•å¼å‰ä»–å½ˆå”±é»æ’­å¹³å° - æœªä¾†é–‹ç™¼è©³ç´°æŒ‡å— v6

> **æ–‡ä»¶ç‰ˆæœ¬**: 6.0  
> **æ›´æ–°æ—¥æœŸ**: 2026-01-14  
> **ç•¶å‰ç‰ˆæœ¬**: v3.0.2  
> **ç›®çš„**: åŸºæ–¼ v3.0.2 æ•ˆèƒ½å¤§å„ªåŒ–ç‰ˆæœ¬å®Œæˆå¾Œï¼Œæä¾›ä¸‹ä¸€éšæ®µçš„å…·é«”é–‹ç™¼å»ºè­°

---

## ğŸ“‹ ç›®éŒ„

1. [å·²å®ŒæˆåŠŸèƒ½ç¸½è¦½](#å·²å®ŒæˆåŠŸèƒ½ç¸½è¦½)
2. [ä¸‹ä¸€æ­¥å„ªå…ˆé …ç›®](#ä¸‹ä¸€æ­¥å„ªå…ˆé …ç›®)
3. [ä¸­æœŸåŠŸèƒ½æ“´å±•](#ä¸­æœŸåŠŸèƒ½æ“´å±•)
4. [é•·æœŸé€²éšåŠŸèƒ½](#é•·æœŸé€²éšåŠŸèƒ½)
5. [æŠ€è¡“å‚µå‹™æ¸…ç†](#æŠ€è¡“å‚µå‹™æ¸…ç†)
6. [æ•ˆèƒ½å„ªåŒ–ç­–ç•¥](#æ•ˆèƒ½å„ªåŒ–ç­–ç•¥)
7. [UI/UX å„ªåŒ–å»ºè­°](#uiux-å„ªåŒ–å»ºè­°)
8. [å®‰å…¨æ€§å¼·åŒ–](#å®‰å…¨æ€§å¼·åŒ–)

---

## âœ… å·²å®ŒæˆåŠŸèƒ½ç¸½è¦½

### v3.0.x ç³»åˆ— - æ•ˆèƒ½å¤§å„ªåŒ–ç‰ˆæœ¬ (2026-01-14) ğŸ†•

| ç‰ˆæœ¬ | é …ç›® | ç‹€æ…‹ | èªªæ˜ |
|------|------|------|------|
| v3.0.2 | Toast/Tooltip ä¿®å¾© | âœ… å®Œæˆ | æ‰€æœ‰è¨Šæ¯æ”¹ç‚ºæ˜ç¢ºèƒŒæ™¯è‰²+é™°å½± |
| v3.0.1 | æˆåŠŸè¨Šæ¯ç¶ è‰²èƒŒæ™¯ | âœ… å®Œæˆ | success variant åŠ æ·±ç¶ è‰² |
| v3.0.0 | ç„¡é™å¾ªç’°å‹•ç•«ç§»é™¤ | âœ… å®Œæˆ | ç§»é™¤ç´„ 88 å€‹ç„¡é™å¾ªç’°å‹•ç•« |
| v3.0.0 | React.memo å„ªåŒ– | âœ… å®Œæˆ | 5+ å€‹å…ƒä»¶è¨˜æ†¶åŒ– |
| v3.0.0 | lazy() å»¶é²è¼‰å…¥ | âœ… å®Œæˆ | 5 å€‹å…ƒä»¶å»¶é²è¼‰å…¥ |
| v3.0.0 | prefers-reduced-motion | âœ… å®Œæˆ | å…¨å±€ç„¡éšœç¤™å‹•ç•«æ”¯æ´ |
| v3.0.0 | useReduceMotion Hook | âœ… å®Œæˆ | çµ±ä¸€å‹•ç•«åå¥½æª¢æ¸¬ |
| v3.0.0 | è™›æ“¬æ»¾å‹• | âœ… å®Œæˆ | è¶…é 30 é¦–æ­Œæ™‚å•Ÿç”¨ |
| v3.0.0 | æœå°‹é˜²æŠ– | âœ… å®Œæˆ | 300ms é˜²æŠ– |

### v2.x ç³»åˆ—å·²å®Œæˆé …ç›®

| ç‰ˆæœ¬ | åŠŸèƒ½ | èªªæ˜ |
|------|------|------|
| v2.5.0 | éŸ¿æ‡‰å¼ Tab UI | æ‰‹æ©Ÿç‰ˆ Tab åˆ‡æ›ä»‹é¢ |
| v2.5.0 | Firestore å®‰å…¨å¼·åŒ– | æŠ•ç¥¨é©—è­‰ã€å…§å®¹é•·åº¦é™åˆ¶ |
| v2.4.0 | å–®å…ƒæ¸¬è©¦æ¡†æ¶ | Vitest + 33 å€‹æ¸¬è©¦æ¡ˆä¾‹ |
| v2.4.0 | ç¨‹å¼ç¢¼åˆ†å‰² | React.lazy å»¶é²è¼‰å…¥ |
| v2.3.0 | æœå°‹åŠŸèƒ½å¼·åŒ– | é—œéµå­—æœå°‹æ‰€æœ‰æ›²åº« |
| v2.1.0 | SongList å…ƒä»¶æ‹†åˆ† | 1033 è¡Œæ‹†åˆ†ç‚º 8 å€‹æ¨¡çµ„ |
| v2.1.0 | ç¶²è·¯ç‹€æ…‹ç›£æ§ | é›¢ç·š/æ…¢é€Ÿé€£ç·šæç¤º |
| v2.1.0 | Firebase Performance | é é¢è¼‰å…¥ã€API è¿½è¹¤ |

---

## ğŸ¯ ä¸‹ä¸€æ­¥å„ªå…ˆé …ç›®

### å„ªå…ˆç´š 1ï¼šæ‰‹å‹¢æ»‘å‹•åˆ‡æ› Tab â­â­â­

**é ä¼°æ™‚é–“**ï¼š2-3 å°æ™‚  
**ç›®æ¨™**ï¼šæ‰‹æ©Ÿç‰ˆæ”¯æ´å·¦å³æ»‘å‹•åˆ‡æ› Tab

```bash
npm install @use-gesture/react
```

```typescript
// hooks/useSwipeGesture.ts
import { useDrag } from '@use-gesture/react';

export function useTabSwipe(
  currentTab: string,
  tabs: string[],
  setTab: (tab: string) => void,
  enabled: boolean = true
) {
  return useDrag(({ swipe: [swipeX] }) => {
    if (!enabled) return;
    const idx = tabs.indexOf(currentTab);
    if (swipeX < 0 && idx < tabs.length - 1) {
      setTab(tabs[idx + 1]);
    } else if (swipeX > 0 && idx > 0) {
      setTab(tabs[idx - 1]);
    }
  }, {
    axis: 'x',
    threshold: 50,
  });
}
```

**åœ¨ MobileTabView ä¸­ä½¿ç”¨**ï¼š
```typescript
const bind = useTabSwipe(activeTab, ['songs', 'ranking'], setActiveTab);
return <div {...bind()} className="touch-none">{/* ... */}</div>;
```

---

### å„ªå…ˆç´š 2ï¼šæ¨¡ç³Šæœå°‹ / æ‹¼éŸ³æœå°‹ â­â­â­

**é ä¼°æ™‚é–“**ï¼š2-3 å°æ™‚  
**ç›®æ¨™**ï¼šæå‡æœå°‹é«”é©—ï¼Œæ”¯æ´æ¨¡ç³ŠåŒ¹é…å’ŒéŒ¯å­—å®¹å¿

```bash
npm install fuse.js
```

```typescript
// hooks/useFuzzySearch.ts
import Fuse, { FuseResult } from 'fuse.js';
import { useMemo, useCallback } from 'react';
import type { Song } from '@/lib/firestore';

interface UseFuzzySearchOptions {
  threshold?: number;    // 0 = å®Œå…¨åŒ¹é…, 1 = ä»»æ„åŒ¹é…
  includeScore?: boolean;
  keys?: string[];
}

export function useFuzzySearch(
  songs: Song[],
  options: UseFuzzySearchOptions = {}
) {
  const {
    threshold = 0.4,
    includeScore = true,
    keys = ['title', 'artist']
  } = options;

  const fuse = useMemo(() => new Fuse(songs, {
    keys,
    threshold,
    includeScore,
    ignoreLocation: true,      // ä¸é™åˆ¶åŒ¹é…ä½ç½®
    minMatchCharLength: 2,     // æœ€å°‘ 2 å­—å…ƒè§¸ç™¼
  }), [songs, keys, threshold, includeScore]);

  const search = useCallback((term: string): Song[] => {
    if (!term.trim()) return songs;
    return fuse.search(term).map((result: FuseResult<Song>) => result.item);
  }, [fuse, songs]);

  return { search };
}
```

**ä½¿ç”¨ç¯„ä¾‹**ï¼š
```typescript
const { search } = useFuzzySearch(allSongs);
const results = search('å‘Šç™½èµ·æ±‚'); // èƒ½æ‰¾åˆ°ã€Œå‘Šç™½æ°£çƒã€
```

---

### å„ªå…ˆç´š 3ï¼šæ¸¬è©¦è¦†è“‹ç‡æå‡è‡³ 20% â­â­

**é ä¼°æ™‚é–“**ï¼š4-5 å°æ™‚  
**ç›®å‰ç‹€æ…‹**ï¼šç´„ 5% (3 å€‹æ¸¬è©¦æª”æ¡ˆ)

**å»ºè­°æ–°å¢æ¸¬è©¦å„ªå…ˆé †åº**ï¼š

| æ¨¡çµ„ | æ¸¬è©¦é¡å‹ | å„ªå…ˆç´š | é ä¼°æ™‚é–“ |
|------|----------|--------|----------|
| `useReduceMotion.ts` | Hook æ¸¬è©¦ | â­â­â­ | 30 åˆ†é˜ |
| `VirtualSongList.tsx` | å…ƒä»¶æ¸¬è©¦ | â­â­â­ | 1 å°æ™‚ |
| `MobileTabView.tsx` | å…ƒä»¶æ¸¬è©¦ | â­â­ | 1 å°æ™‚ |
| `SongCard.tsx` | å…ƒä»¶æ¸¬è©¦ | â­â­ | 1 å°æ™‚ |
| `useVoting.tsx` | Hook æ¸¬è©¦ | â­ | 1.5 å°æ™‚ |

**useReduceMotion æ¸¬è©¦ç¯„ä¾‹**ï¼š

```typescript
// hooks/useReduceMotion.test.ts
import { renderHook, cleanup } from '@testing-library/react';
import { describe, it, expect, vi, beforeEach, afterEach } from 'vitest';
import { useReduceMotion } from './useReduceMotion';

describe('useReduceMotion', () => {
  let matchMediaMock: ReturnType<typeof vi.fn>;
  
  beforeEach(() => {
    matchMediaMock = vi.fn().mockImplementation((query: string) => ({
      matches: false,
      media: query,
      addEventListener: vi.fn(),
      removeEventListener: vi.fn(),
    }));
    window.matchMedia = matchMediaMock;
  });

  afterEach(() => {
    cleanup();
    vi.clearAllMocks();
  });

  it('æ‡‰è©²è¿”å› false ç•¶ç”¨æˆ¶æœªè¨­å®šæ¸›å°‘å‹•ç•«åå¥½', () => {
    const { result } = renderHook(() => useReduceMotion());
    expect(result.current).toBe(false);
  });

  it('æ‡‰è©²è¿”å› true ç•¶ç”¨æˆ¶è¨­å®šæ¸›å°‘å‹•ç•«åå¥½', () => {
    matchMediaMock.mockImplementation((query: string) => ({
      matches: query === '(prefers-reduced-motion: reduce)',
      media: query,
      addEventListener: vi.fn(),
      removeEventListener: vi.fn(),
    }));
    
    const { result } = renderHook(() => useReduceMotion());
    expect(result.current).toBe(true);
  });
});
```

---

### å„ªå…ˆç´š 4ï¼šæ·±è‰²æ¨¡å¼å®Œå–„ â­â­

**é ä¼°æ™‚é–“**ï¼š3-4 å°æ™‚  
**ç›®æ¨™**ï¼šç¢ºä¿æ‰€æœ‰å…ƒä»¶åœ¨æ·±è‰²æ¨¡å¼ä¸‹æ­£ç¢ºé¡¯ç¤º

**å¾…æª¢æŸ¥å…ƒä»¶æ¸…å–®**ï¼š
- [ ] Toast è¨Šæ¯åœ¨æ·±è‰²æ¨¡å¼ä¸‹çš„å°æ¯”åº¦
- [ ] Tooltip åœ¨æ·±è‰²æ¨¡å¼ä¸‹çš„å¯è®€æ€§
- [ ] VirtualSongList æ»¾å‹•æ¢æ¨£å¼
- [ ] æœå°‹æ¬„ä½ç„¦é»ç‹€æ…‹
- [ ] éª¨æ¶å±é¡è‰²èª¿æ•´

**å¯¦ä½œå»ºè­°**ï¼š
```css
/* index.css å¢åŠ æ·±è‰²æ¨¡å¼è®Šæ•¸ */
:root {
  --toast-bg-success: theme('colors.green.100');
  --toast-border-success: theme('colors.green.300');
}

.dark {
  --toast-bg-success: theme('colors.green.900');
  --toast-border-success: theme('colors.green.700');
}
```

---

## ğŸš€ ä¸­æœŸåŠŸèƒ½æ“´å±• (2-4 é€±)

### 1. PWA é›¢ç·šæ”¯æ´

**é ä¼°æ™‚é–“**ï¼š5-6 å°æ™‚

```bash
npm install vite-plugin-pwa -D
```

**åŠŸèƒ½æ¸…å–®**ï¼š
| åŠŸèƒ½ | èªªæ˜ | è¤‡é›œåº¦ |
|------|------|--------|
| Service Worker ç·©å­˜ | ç·©å­˜éœæ…‹è³‡æº | ä½ |
| é›¢ç·šæ­Œå–®æª¢è¦– | é›¢ç·šæ™‚é¡¯ç¤ºå·²å¿«å–æ­Œæ›² | ä¸­ |
| å®‰è£æç¤ºå¼•å° | å¼•å°ä½¿ç”¨è€…å®‰è£ PWA | ä½ |
| èƒŒæ™¯åŒæ­¥ | é›¢ç·šæŠ•ç¥¨å¾Œä¸Šç·šè‡ªå‹•åŒæ­¥ | é«˜ |

**vite.config.ts é…ç½®**ï¼š
```typescript
import { VitePWA } from 'vite-plugin-pwa';

export default defineConfig({
  plugins: [
    react(),
    VitePWA({
      registerType: 'autoUpdate',
      includeAssets: ['favicon.ico', 'apple-touch-icon.png'],
      manifest: {
        name: 'å‰ä»–é»æ­Œç³»çµ±',
        short_name: 'é»æ­Œ',
        theme_color: '#f59e0b',
        background_color: '#ffffff',
        display: 'standalone',
        icons: [
          { src: '/icon-192.png', sizes: '192x192', type: 'image/png' },
          { src: '/icon-512.png', sizes: '512x512', type: 'image/png' }
        ]
      },
      workbox: {
        globPatterns: ['**/*.{js,css,html,ico,png,svg,woff2}'],
        runtimeCaching: [
          {
            urlPattern: /^https:\/\/firestore\.googleapis\.com/,
            handler: 'NetworkFirst',
            options: { cacheName: 'firestore-cache' }
          }
        ]
      }
    })
  ]
});
```

---

### 2. çµ±è¨ˆå„€è¡¨æ¿

**é ä¼°æ™‚é–“**ï¼š8-10 å°æ™‚

```bash
npm install recharts date-fns
```

**ç›®éŒ„çµæ§‹**ï¼š
```
components/StatsDashboard/
â”œâ”€â”€ index.tsx            (ä¸»é é¢)
â”œâ”€â”€ QuickStats.tsx       (å¿«é€Ÿçµ±è¨ˆå¡ç‰‡)
â”œâ”€â”€ VoteTrendChart.tsx   (æŠ•ç¥¨è¶¨å‹¢åœ–)
â”œâ”€â”€ TopSongsChart.tsx    (ç†±é–€æ­Œæ›²é•·æ¢åœ–)
â”œâ”€â”€ HourlyHeatmap.tsx    (æ´»èºæ™‚æ®µç†±åŠ›åœ–)
â””â”€â”€ hooks/useStats.ts    (çµ±è¨ˆè³‡æ–™ Hook)
```

**Firestore è³‡æ–™çµæ§‹**ï¼š
```typescript
// collections: stats/{date}
interface DailyStat {
  date: string;              // "2026-01-14"
  totalVotes: number;        // ç•¶æ—¥ç¸½æŠ•ç¥¨æ•¸
  uniqueVisitors: number;    // ä¸é‡è¤‡è¨ªå®¢
  topSongs: {
    songId: string;
    title: string;
    artist: string;
    votes: number;
  }[];
  hourlyDistribution: Record<string, number>;  // { "20": 45, "21": 62 }
}
```

**QuickStats å…ƒä»¶ç¯„ä¾‹**ï¼š
```typescript
// components/StatsDashboard/QuickStats.tsx
interface QuickStatsProps {
  totalVotes: number;
  todayVotes: number;
  activeSongs: number;
  topSong: string;
}

export function QuickStats({ totalVotes, todayVotes, activeSongs, topSong }: QuickStatsProps) {
  return (
    <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
      <StatCard title="ç¸½æŠ•ç¥¨æ•¸" value={totalVotes} icon="ğŸ—³ï¸" />
      <StatCard title="ä»Šæ—¥æŠ•ç¥¨" value={todayVotes} trend="+12%" icon="ğŸ“ˆ" />
      <StatCard title="æ›²åº«æ•¸é‡" value={activeSongs} icon="ğŸµ" />
      <StatCard title="äººæ°£å† è»" value={topSong} icon="ğŸ‘‘" />
    </div>
  );
}
```

---

### 3. ç¤¾ç¾¤ç™»å…¥æ•´åˆ

**é ä¼°æ™‚é–“**ï¼š3-4 å°æ™‚

```mermaid
flowchart LR
    A[ä½¿ç”¨è€…] --> B{é¸æ“‡ç™»å…¥æ–¹å¼}
    B --> C[ğŸ“§ Email/å¯†ç¢¼]
    B --> D[ğŸ”´ Google]
    B --> E[ğŸ”µ Facebook]
    C --> F[Firebase Auth]
    D --> F
    E --> F
    F --> G[ç™»å…¥æˆåŠŸ]
```

**å¯¦ä½œç¨‹å¼ç¢¼**ï¼š
```typescript
// lib/auth.ts æ“´å……
import { 
  GoogleAuthProvider, 
  FacebookAuthProvider,
  signInWithPopup,
  signInWithRedirect,
  getRedirectResult
} from 'firebase/auth';
import { auth } from './firebase';

export async function signInWithGoogle() {
  const provider = new GoogleAuthProvider();
  provider.addScope('profile');
  provider.addScope('email');
  
  try {
    const result = await signInWithPopup(auth, provider);
    return { user: result.user, error: null };
  } catch (error) {
    // æ‰‹æ©Ÿä¸Šå¯èƒ½éœ€è¦ç”¨ redirect
    if ((error as any).code === 'auth/popup-blocked') {
      await signInWithRedirect(auth, provider);
      const result = await getRedirectResult(auth);
      return { user: result?.user || null, error: null };
    }
    return { user: null, error: error as Error };
  }
}

export async function signInWithFacebook() {
  const provider = new FacebookAuthProvider();
  provider.addScope('public_profile');
  
  const result = await signInWithPopup(auth, provider);
  return result.user;
}
```

---

### 4. é»æ’­æ­·å²è¨˜éŒ„

**é ä¼°æ™‚é–“**ï¼š3-4 å°æ™‚

**åŠŸèƒ½éœ€æ±‚**ï¼š
- æœ¬æ©Ÿ localStorage å„²å­˜é»æ’­è¨˜éŒ„
- é¡¯ç¤ºã€Œæ‚¨ä»Šæ—¥å·²é»æ’­ X é¦–ã€
- æŸ¥çœ‹æ­·å²é»æ’­åˆ—è¡¨
- å¿«é€Ÿé‡è¤‡é»æ’­åŠŸèƒ½

```typescript
// hooks/useVoteHistory.ts
import { useState, useEffect, useCallback } from 'react';

interface VoteRecord {
  songId: string;
  songTitle: string;
  artist: string;
  votedAt: string;  // ISO å­—ä¸²
}

const STORAGE_KEY = 'vote_history';
const MAX_RECORDS = 50;

export function useVoteHistory() {
  const [history, setHistory] = useState<VoteRecord[]>([]);

  useEffect(() => {
    const stored = localStorage.getItem(STORAGE_KEY);
    if (stored) {
      setHistory(JSON.parse(stored));
    }
  }, []);

  const addRecord = useCallback((song: { id: string; title: string; artist: string }) => {
    const newRecord: VoteRecord = {
      songId: song.id,
      songTitle: song.title,
      artist: song.artist,
      votedAt: new Date().toISOString(),
    };

    setHistory(prev => {
      const updated = [newRecord, ...prev].slice(0, MAX_RECORDS);
      localStorage.setItem(STORAGE_KEY, JSON.stringify(updated));
      return updated;
    });
  }, []);

  const todayCount = history.filter(r => 
    new Date(r.votedAt).toDateString() === new Date().toDateString()
  ).length;

  return { history, addRecord, todayCount };
}
```

---

## ğŸŒŸ é•·æœŸé€²éšåŠŸèƒ½ (1-3 å€‹æœˆ)

| åŠŸèƒ½ | é ä¼°æ™‚é–“ | è¤‡é›œåº¦ | èªªæ˜ |
|------|----------|--------|------|
| æ­Œè©åŒæ­¥æ’­æ”¾ | 10-15 å°æ™‚ | é«˜ | LRC æ ¼å¼ã€YouTube åµŒå…¥ |
| å¤šèªç³» (i18n) | 6-8 å°æ™‚ | ä¸­ | react-i18next æ•´åˆ |
| æ¨æ’­é€šçŸ¥ (FCM) | 8-10 å°æ™‚ | é«˜ | æ­Œæ›²é€²å…¥ Top 3 é€šçŸ¥ |
| è§’è‰²æ¬Šé™ç®¡ç† | 6-8 å°æ™‚ | ä¸­ | guest/user/admin æ¬Šé™ |
| æ­Œæ›²æ”¶è—å¤¾ | 4-5 å°æ™‚ | ä¸­ | ä½¿ç”¨è€…å€‹äººæ”¶è— |
| ç¾å ´è¡¨æ¼”æ¨¡å¼ | 8-10 å°æ™‚ | é«˜ | å¤§è¢å¹•æŠ•å½±é¡¯ç¤º |
| ç©åˆ†å‹³ç« ç³»çµ± | 12-15 å°æ™‚ | é«˜ | é»æ’­ç²å¾—ç©åˆ†ã€ç­‰ç´š |

### æ­Œè©åŒæ­¥æ’­æ”¾è¨­è¨ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸµ å‘Šç™½æ°£çƒ - å‘¨æ°å€«              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚    å¡ç´æ²³ç•” å·¦å²¸çš„å’–å•¡              â”‚
â”‚    æˆ‘æ‰‹ä¸€æ¯ å“åšä½ çš„ç¾              â”‚ â† ç•¶å‰æ­Œè©é«˜äº®
â”‚    ç•™ä¸‹å”‡å° çš„å˜´                    â”‚
â”‚                                     â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â—â”â”â”â”â”â”â”â”â”            â”‚
â”‚  01:23           03:45              â”‚
â”‚         [â–¶] [ â†» ] [ â™ª ]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æŠ€è¡“è€ƒé‡**ï¼š
- æ­Œè©æ ¼å¼ï¼šLRC (æ™‚é–“è»¸åŒæ­¥)
- å„²å­˜ä½ç½®ï¼šFirestore `songs/{id}/lyrics` å­é›†åˆ
- éŸ³æºï¼šYouTube åµŒå…¥ or éŸ³æª”ä¸Šå‚³è‡³ Firebase Storage

---

## ğŸ”§ æŠ€è¡“å‚µå‹™æ¸…ç†

### å¾…è™•ç†é …ç›®

| é …ç›® | å„ªå…ˆç´š | ç›®å‰ç‹€æ…‹ | å»ºè­°åšæ³• |
|------|--------|----------|----------|
| æ¸¬è©¦è¦†è“‹ç‡ | ğŸ”´ é«˜ | ç´„ 5% | ç›®æ¨™ 20% |
| Bundle å„ªåŒ– | ğŸŸ¡ ä¸­ | ~1 MB | Tree-shaking < 600KB |
| ç§»é™¤æœªç”¨ä¾è³´ | ğŸŸ¢ ä½ | react-query ç­‰ | `npm prune` |
| æ¨™ç±¤ç³»çµ±é·ç§» | ğŸŸ¡ ä¸­ | ä»ç”¨ /api/tags | æ”¹ç”¨ Firestore |
| æ·±è‰²æ¨¡å¼å®Œå–„ | ğŸŸ¡ ä¸­ | éƒ¨åˆ†å…ƒä»¶ä¸ä½³ | çµ±ä¸€ CSS è®Šæ•¸ |

### å·²å®Œæˆ âœ…

- âœ… å–®å…ƒæ¸¬è©¦æ¡†æ¶ (Vitest)
- âœ… useSongSearch æ¸¬è©¦ (11 tests)
- âœ… error-handler æ¸¬è©¦ (22 tests)
- âœ… useVoting æ¸¬è©¦
- âœ… ç¨‹å¼ç¢¼åˆ†å‰² (lazy loading)
- âœ… è™›æ“¬æ»¾å‹• (VirtualSongList)
- âœ… React.memo å„ªåŒ–
- âœ… ç„¡é™å¾ªç’°å‹•ç•«ç§»é™¤
- âœ… prefers-reduced-motion æ”¯æ´
- âœ… Toast/Tooltip é€æ˜åº¦ä¿®å¾©

---

## ğŸ“ˆ æ•ˆèƒ½å„ªåŒ–ç­–ç•¥

### ç›®å‰ç‹€æ…‹ vs ç›®æ¨™

| æŒ‡æ¨™ | ç›®å‰ | ç›®æ¨™ | å„ªåŒ–æ–¹å¼ |
|------|------|------|----------|
| æ¸¬è©¦è¦†è“‹ç‡ | ~5% | 20% | æ–°å¢ Hook/å…ƒä»¶æ¸¬è©¦ |
| Bundle Size | ~1 MB | < 600 KB | Tree-shakingã€å‹•æ…‹è¼‰å…¥ |
| FCP | ~1.5s | < 1.0s | é è¼‰å…¥ã€éª¨æ¶å± |
| LCP | ~2.5s | < 2.0s | åœ–ç‰‡æ‡¶åŠ è¼‰ |
| ç„¡é™å‹•ç•« | 0 | 0 | âœ… å·²å…¨éƒ¨ç§»é™¤ |
| è™›æ“¬æ»¾å‹• | âœ… | âœ… | è¶…é 30 é¦–å•Ÿç”¨ |

### Bundle å„ªåŒ–ç­–ç•¥

```typescript
// vite.config.ts - åˆ†å‰²ç­–ç•¥
export default defineConfig({
  build: {
    rollupOptions: {
      output: {
        manualChunks: {
          'react-vendor': ['react', 'react-dom'],
          'firebase': ['firebase/app', 'firebase/firestore', 'firebase/auth'],
          'ui-vendor': ['framer-motion', '@radix-ui/react-dialog'],
          'charts': ['recharts'],  // æœªä¾†çµ±è¨ˆå„€è¡¨æ¿
        }
      }
    }
  }
});
```

---

## ğŸ¨ UI/UX å„ªåŒ–å»ºè­°

### 1. SongSuggestion å…ƒä»¶å„ªåŒ–

| å•é¡Œ | å»ºè­°æ”¹é€² |
|------|----------|
| æ­Œæ‰‹æ¬„ä½å¯é¸å¡«ä¸æ˜é¡¯ | åŠ å…¥ç°è‰²æç¤ºæ–‡å­—ã€Œ(é¸å¡«)ã€ |
| é€å‡ºæŒ‰éˆ•ä½ç½® | æ”¹ç‚ºç½®ä¸­æˆ–é å³å°é½Š |
| æˆåŠŸåé¥‹ä¸è¶³ | åŠ å…¥å‹•ç•«ç¢ºèªæ•ˆæœ |
| è¡¨å–®é‡ç½®æ™‚æ©Ÿ | é€å‡ºæˆåŠŸå¾Œè‡ªå‹•æ¸…ç©º |

### 2. LoginForm å…ƒä»¶å„ªåŒ–

| å•é¡Œ | å»ºè­°æ”¹é€² |
|------|----------|
| å¯†ç¢¼å¯è¦‹åˆ‡æ› | åŠ å…¥çœ¼ç›åœ–ç¤ºåˆ‡æ› |
| éŒ¯èª¤è¨Šæ¯é¡¯ç¤º | ä½¿ç”¨ç´…è‰²é‚Šæ¡†+æç¤ºæ–‡å­— |
| éµç›¤å°èˆª | ç¢ºä¿ Tab é †åºæ­£ç¢º |
| è¼‰å…¥ç‹€æ…‹ | æŒ‰éˆ•åŠ å…¥ spinner |

### 3. éŸ¿æ‡‰å¼è¨­è¨ˆæ”¹é€²

```
æ¡Œé¢ç‰ˆ (1024px+)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [æ­Œæ›²åˆ—è¡¨ 60%] â”‚ [æ’è¡Œæ¦œ 40%]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¹³æ¿ (768px-1023px)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [æ­Œæ›²åˆ—è¡¨ 100%]                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [æ’è¡Œæ¦œ 100%]                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ‰‹æ©Ÿ (< 768px)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Tab: æ­Œæ›²/æ’è¡Œæ¦œ] â”‚ â† æ”¯æ´æ‰‹å‹¢æ»‘å‹•åˆ‡æ›
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ç•¶å‰Tabå…§å®¹]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ›¡ï¸ å®‰å…¨æ€§å¼·åŒ–

### Firestore è¦å‰‡é€²éšå„ªåŒ–

```javascript
// firestore.rules - é€²éšé˜²è­·
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // æŠ•ç¥¨é€Ÿç‡é™åˆ¶ï¼šæ¯åˆ†é˜æœ€å¤š 10 ç¥¨
    function isRateLimited(userId) {
      let recentVotes = getAfter(
        /databases/$(database)/documents/votes
      ).data.createdAt > request.time - duration.value(1, 'm');
      return recentVotes < 10;
    }
    
    // å»ºè­°å…§å®¹éæ¿¾
    match /songSuggestions/{suggestionId} {
      allow create: if request.auth != null
        && request.resource.data.title.size() >= 1
        && request.resource.data.title.size() <= 100
        && request.resource.data.artist.size() <= 50
        && (!request.resource.data.keys().hasAny(['notes']) 
            || request.resource.data.notes.size() <= 500);
    }
  }
}
```

### å¾…åŠ å¼·é …ç›®

| é …ç›® | ç›®å‰ç‹€æ…‹ | å»ºè­° |
|------|----------|------|
| Rate Limiting | å‰ç«¯é˜²é€£é» | å¾Œç«¯ API é™æµ |
| è¼¸å…¥é©—è­‰ | åŸºæœ¬é©—è­‰ | åŠ å¼· XSS éæ¿¾ |
| HTTPS å¼·åˆ¶ | å·²å•Ÿç”¨ | è¨­å®š HSTS header |
| Content Security Policy | æœªè¨­å®š | åŠ å…¥ CSP header |

---

## ğŸ“… å»ºè­°å¯¦æ–½æ™‚ç¨‹

```mermaid
gantt
    title v3.1.0+ é–‹ç™¼é‡Œç¨‹ç¢‘
    dateFormat  YYYY-MM-DD
    section çŸ­æœŸ (æœ¬é€±)
    æ‰‹å‹¢æ»‘å‹•åˆ‡æ› Tab    :a1, 2026-01-15, 1d
    æ¨¡ç³Šæœå°‹å¯¦ä½œ        :a2, 2026-01-16, 1d
    æ·±è‰²æ¨¡å¼å®Œå–„        :a3, 2026-01-17, 1d
    section ä¸­æœŸ (2-3é€±)
    æ¸¬è©¦è¦†è“‹ç‡æå‡      :b1, 2026-01-18, 3d
    PWA é›¢ç·šæ”¯æ´        :b2, 2026-01-22, 3d
    é»æ’­æ­·å²è¨˜éŒ„        :b3, 2026-01-25, 2d
    section é•·æœŸ (1å€‹æœˆ+)
    çµ±è¨ˆå„€è¡¨æ¿          :c1, 2026-01-28, 5d
    ç¤¾ç¾¤ç™»å…¥æ•´åˆ        :c2, 2026-02-03, 3d
    æ­Œè©åŒæ­¥æ’­æ”¾        :c3, 2026-02-07, 7d
```

---

## ğŸ“‹ å¿«é€Ÿé–‹å§‹æª¢æŸ¥æ¸…å–®

### æœ¬é€±å¯å®Œæˆ (v3.1.0)

- [ ] æ‰‹å‹¢æ»‘å‹•åˆ‡æ› Tab (2-3 å°æ™‚)
- [ ] æ¨¡ç³Šæœå°‹ / Fuse.js æ•´åˆ (2-3 å°æ™‚)
- [ ] æ·±è‰²æ¨¡å¼ Toast/Tooltip æª¢æŸ¥ (1 å°æ™‚)
- [ ] useReduceMotion æ¸¬è©¦ (30 åˆ†é˜)

### ä¸‹é€±è¦åŠƒ (v3.2.0)

- [ ] VirtualSongList æ¸¬è©¦
- [ ] MobileTabView æ¸¬è©¦
- [ ] æ¸¬è©¦è¦†è“‹ç‡ â†’ 15%
- [ ] PWA åŸºç¤é…ç½®

### æœˆåº•ç›®æ¨™

- [ ] æ¸¬è©¦è¦†è“‹ç‡ â†’ 20%
- [ ] PWA å®Œæ•´æ”¯æ´
- [ ] é»æ’­æ­·å²è¨˜éŒ„åŠŸèƒ½
- [ ] çµ±è¨ˆå„€è¡¨æ¿åŸºç¤ç‰ˆ

---

## ğŸ’¡ å¿«é€ŸæŒ‡ä»¤

```bash
# é–‹ç™¼æ¨¡å¼
npm run dev

# æ¸¬è©¦
npm run test          # ç›£è½æ¨¡å¼
npm run test:run      # å–®æ¬¡åŸ·è¡Œ
npm run test:coverage # è¦†è“‹ç‡å ±å‘Š

# å»ºç½®
npm run build

# é¡å‹æª¢æŸ¥
npm run check

# æ–°å¢ä¾è³´å»ºè­°
npm install fuse.js              # æ¨¡ç³Šæœå°‹
npm install @use-gesture/react   # æ‰‹å‹¢æ”¯æ´
npm install vite-plugin-pwa -D   # PWA
npm install recharts             # åœ–è¡¨
```

---

*æœ€å¾Œæ›´æ–°ï¼š2026-01-14 v3.0.2*
*ä¸‹æ¬¡å»ºè­°æ›´æ–°æ™‚æ©Ÿï¼šå®Œæˆ v3.1.0 å¾Œ*

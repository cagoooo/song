# ğŸš€ äº’å‹•å¼å‰ä»–å½ˆå”±é»æ’­å¹³å° - æœªä¾†é–‹ç™¼è©³ç´°æŒ‡å—

> **æ–‡ä»¶ç‰ˆæœ¬**: 1.0  
> **å»ºç«‹æ—¥æœŸ**: 2026-01-13  
> **é©ç”¨ç‰ˆæœ¬**: v2.0.0+  
> **ç›®çš„**: æä¾›å…·é«”ã€å¯åŸ·è¡Œçš„é–‹ç™¼å»ºè­°èˆ‡å¯¦ä½œç´°ç¯€

---

## ğŸ“‹ ç›®éŒ„

1. [å¿«é€Ÿå°è¦½](#å¿«é€Ÿå°è¦½)
2. [ç«‹å³å¯åšçš„å„ªåŒ– (1-3 å¤©)](#ç«‹å³å¯åšçš„å„ªåŒ–-1-3-å¤©)
3. [çŸ­æœŸå¼·åŒ–é …ç›® (1-2 é€±)](#çŸ­æœŸå¼·åŒ–é …ç›®-1-2-é€±)
4. [ä¸­æœŸåŠŸèƒ½é–‹ç™¼ (2-4 é€±)](#ä¸­æœŸåŠŸèƒ½é–‹ç™¼-2-4-é€±)
5. [é•·æœŸé€²éšç™¼å±• (1-3 å€‹æœˆ)](#é•·æœŸé€²éšç™¼å±•-1-3-å€‹æœˆ)
6. [ç¨‹å¼ç¢¼å“è³ªæå‡](#ç¨‹å¼ç¢¼å“è³ªæå‡)
7. [æ•ˆèƒ½å„ªåŒ–ç­–ç•¥](#æ•ˆèƒ½å„ªåŒ–ç­–ç•¥)
8. [éƒ¨ç½²èˆ‡ç¶­é‹å»ºè­°](#éƒ¨ç½²èˆ‡ç¶­é‹å»ºè­°)
9. [å•†æ¥­åŒ–æ–¹å‘æ¢ç´¢](#å•†æ¥­åŒ–æ–¹å‘æ¢ç´¢)
10. [å­¸ç¿’è³‡æºèˆ‡åƒè€ƒ](#å­¸ç¿’è³‡æºèˆ‡åƒè€ƒ)

---

## å¿«é€Ÿå°è¦½

### ğŸ¯ å„ªå…ˆç´šåˆ†é¡

| æ¨™è¨˜ | ç­‰ç´š | å»ºè­°æŠ•å…¥ | é æœŸæ”¶ç›Š |
|------|------|----------|----------|
| ğŸ”¥ | ç«‹å³ | 1-3 å¤© | å¿«é€Ÿè¦‹æ•ˆï¼Œä½é¢¨éšª |
| â­ | çŸ­æœŸ | 1-2 é€± | é¡¯è‘—æ”¹å–„ï¼Œä¸­ç­‰æŠ•å…¥ |
| ğŸš€ | ä¸­æœŸ | 2-4 é€± | åŠŸèƒ½æ“´å±•ï¼Œç”¨æˆ¶åƒ¹å€¼é«˜ |
| ğŸŒŸ | é•·æœŸ | 1-3 å€‹æœˆ | é€²éšåŠŸèƒ½ï¼Œé«˜è¤‡é›œåº¦ |

### ğŸ“Š å»ºè­°å„ªå…ˆé †åºåœ–

```
é‡è¦ç¨‹åº¦
   â†‘
é«˜ â”‚  ğŸ”¥ TypeScript åš´æ ¼æ¨¡å¼    â­ PWA é›¢ç·šæ”¯æ´
   â”‚  ğŸ”¥ æ¨™ç±¤ç³»çµ±ä¿®å¾©           â­ ç¤¾ç¾¤ç™»å…¥æ•´åˆ
   â”‚  ğŸ”¥ éŒ¯èª¤è™•ç†å„ªåŒ–           ğŸš€ æ­Œè©åŒæ­¥æ’­æ”¾
ä¸­ â”‚  â­ å…ƒä»¶æ‹†åˆ†é‡æ§‹           ğŸš€ çµ±è¨ˆå„€è¡¨æ¿
   â”‚  â­ æ•ˆèƒ½ç›£æ§              ğŸŒŸ é€šçŸ¥ç³»çµ±
ä½ â”‚  ğŸŒŸ å¤šèªç³»æ”¯æ´             ğŸŒŸ A/B æ¸¬è©¦
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’
      ä½                                    é«˜
                  å¯¦æ–½è¤‡é›œåº¦
```

---

## ğŸ”¥ ç«‹å³å¯åšçš„å„ªåŒ– (1-3 å¤©)

### 1. TypeScript åš´æ ¼æ¨¡å¼æ¢å¾©

**å•é¡Œæè¿°**ï¼š  
ç›®å‰ `tsconfig.json` ä¸­ `strict` å’Œ `noImplicitAny` è¨­ç‚º `false`ï¼Œå¯èƒ½å°è‡´æ½›åœ¨çš„å‹åˆ¥éŒ¯èª¤è¢«å¿½ç•¥ã€‚

**å¯¦æ–½æ­¥é©Ÿ**ï¼š

#### Step 1ï¼šæ¼¸é€²å¼å•Ÿç”¨åš´æ ¼æ¨¡å¼

```json
// tsconfig.json - éšæ®µ 1
{
  "compilerOptions": {
    "strict": false,
    "noImplicitAny": true,  // å…ˆå•Ÿç”¨é€™å€‹
    "strictNullChecks": false,
    "strictFunctionTypes": false
  }
}
```

#### Step 2ï¼šä¿®å¾©ä¸»è¦å•é¡Œæª”æ¡ˆ

| æª”æ¡ˆ | å•é¡Œ | ä¿®å¾©å»ºè­° |
|------|------|----------|
| `TagSelector.tsx` | ä½¿ç”¨èˆŠ API å‘¼å« | æ”¹ç”¨ `firestore.ts` å‡½å¼ |
| `MusicPlayer.tsx` | éš±å¼ any å‹åˆ¥ | æ·»åŠ  `ITrack` ä»‹é¢ |
| `RankingBoard.tsx` | è¤‡é›œç‹€æ…‹å‹åˆ¥ | ä½¿ç”¨æ³›å‹å®šç¾© |
| `SongList.tsx` | éå¤§å…ƒä»¶ | æ‹†åˆ†å­å…ƒä»¶ |

#### Step 3ï¼šå®Œå…¨å•Ÿç”¨åš´æ ¼æ¨¡å¼

```json
// tsconfig.json - æœ€çµ‚ç‰ˆæœ¬
{
  "compilerOptions": {
    "strict": true,
    "noImplicitAny": true,
    "strictNullChecks": true,
    "strictFunctionTypes": true,
    "noImplicitReturns": true,
    "noFallthroughCasesInSwitch": true
  }
}
```

**é©—è­‰æ–¹æ³•**ï¼š
```bash
npm run check  # ç¢ºä¿ç„¡ TypeScript éŒ¯èª¤
npm run build  # ç¢ºä¿å»ºç½®æˆåŠŸ
```

---

### 2. æ¨™ç±¤ç³»çµ± Firestore é·ç§»

**å•é¡Œæè¿°**ï¼š  
`TagSelector.tsx` ä»æ®˜ç•™èˆŠ API å‘¼å«ï¼Œéœ€å®Œå…¨é·ç§»è‡³ Firestoreã€‚

**å»ºè­°æ–°å¢ Hook**ï¼š

```typescript
// client/src/hooks/use-tags.ts
import { useState, useEffect, useCallback } from 'react';
import { 
  getTags, 
  addTag, 
  getSongTags, 
  addSongTag, 
  removeSongTag 
} from '@/lib/firestore';

interface Tag {
  id: string;
  name: string;
  color?: string;
}

export function useTags() {
  const [tags, setTags] = useState<Tag[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<Error | null>(null);

  const fetchTags = useCallback(async () => {
    try {
      setLoading(true);
      const fetchedTags = await getTags();
      setTags(fetchedTags);
      setError(null);
    } catch (err) {
      setError(err instanceof Error ? err : new Error('è¼‰å…¥æ¨™ç±¤å¤±æ•—'));
    } finally {
      setLoading(false);
    }
  }, []);

  useEffect(() => {
    fetchTags();
  }, [fetchTags]);

  const createTag = async (name: string, color?: string) => {
    const newTag = await addTag(name, color);
    await fetchTags(); // é‡æ–°è¼‰å…¥
    return newTag;
  };

  return {
    tags,
    loading,
    error,
    createTag,
    getSongTags,
    addSongTag,
    removeSongTag,
    refetch: fetchTags,
  };
}
```

---

### 3. å‹å–„éŒ¯èª¤è™•ç†

**å»ºè­°æ–°å¢éŒ¯èª¤è™•ç†æ¨¡çµ„**ï¼š

```typescript
// client/src/lib/error-handler.ts
import { FirebaseError } from 'firebase/app';
import { toast } from '@/components/ui/sonner'; // å‡è¨­ä½¿ç”¨ sonner

// éŒ¯èª¤ç¢¼å°æ‡‰ä¸­æ–‡è¨Šæ¯
const ERROR_MESSAGES: Record<string, string> = {
  // Firestore éŒ¯èª¤
  'permission-denied': 'æ‚¨æ²’æœ‰æ¬Šé™åŸ·è¡Œæ­¤æ“ä½œ',
  'unavailable': 'ä¼ºæœå™¨æš«æ™‚ç„¡æ³•ä½¿ç”¨ï¼Œè«‹ç¨å¾Œå†è©¦',
  'not-found': 'æ‰¾ä¸åˆ°è«‹æ±‚çš„è³‡æº',
  'already-exists': 'æ­¤é …ç›®å·²å­˜åœ¨',
  'resource-exhausted': 'è«‹æ±‚éæ–¼é »ç¹ï¼Œè«‹ç¨å¾Œå†è©¦',
  'cancelled': 'æ“ä½œå·²å–æ¶ˆ',
  'data-loss': 'è³‡æ–™éºå¤±ï¼Œè«‹è¯ç¹«ç®¡ç†å“¡',
  'unauthenticated': 'è«‹å…ˆç™»å…¥å¾Œå†æ“ä½œ',
  
  // Auth éŒ¯èª¤
  'auth/user-not-found': 'æ‰¾ä¸åˆ°æ­¤ä½¿ç”¨è€…',
  'auth/wrong-password': 'å¯†ç¢¼éŒ¯èª¤',
  'auth/email-already-in-use': 'æ­¤é›»å­éƒµä»¶å·²è¢«ä½¿ç”¨',
  'auth/too-many-requests': 'ç™»å…¥å˜—è©¦éå¤šï¼Œè«‹ç¨å¾Œå†è©¦',
  'auth/network-request-failed': 'ç¶²è·¯é€£ç·šå¤±æ•—',
};

export function handleError(error: unknown): string {
  if (error instanceof FirebaseError) {
    return ERROR_MESSAGES[error.code] || `ç™¼ç”ŸéŒ¯èª¤ï¼š${error.message}`;
  }
  
  if (error instanceof Error) {
    return error.message;
  }
  
  return 'ç™¼ç”ŸæœªçŸ¥éŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦';
}

// é¡¯ç¤ºéŒ¯èª¤æç¤º
export function showError(error: unknown) {
  const message = handleError(error);
  toast.error(message);
  
  // é–‹ç™¼ç’°å¢ƒä¸‹å°å‡ºå®Œæ•´éŒ¯èª¤
  if (import.meta.env.DEV) {
    console.error('Error details:', error);
  }
}

// åŒ…è£ async å‡½å¼ä¸¦è‡ªå‹•è™•ç†éŒ¯èª¤
export function withErrorHandling<T extends (...args: any[]) => Promise<any>>(
  fn: T,
  options?: { showToast?: boolean }
): T {
  return (async (...args: Parameters<T>) => {
    try {
      return await fn(...args);
    } catch (error) {
      if (options?.showToast !== false) {
        showError(error);
      }
      throw error;
    }
  }) as T;
}
```

---

## â­ çŸ­æœŸå¼·åŒ–é …ç›® (1-2 é€±)

### 4. å¤§å‹å…ƒä»¶æ‹†åˆ†é‡æ§‹

**ç¾æ³å•é¡Œ**ï¼š
- `SongList.tsx` ç´„ 45KB / 1000+ è¡Œ
- `RankingBoard.tsx` ç´„ 49KB
- `SongSuggestion.tsx` ç´„ 34KB

**å»ºè­°æ‹†åˆ†æ–¹æ¡ˆ**ï¼š

```
SongList.tsx (45KB)
â”œâ”€â”€ SongList.tsx (ä¸»å®¹å™¨ï¼Œç´„ 10KB)
â”œâ”€â”€ SongCard.tsx (å–®ä¸€æ­Œæ›²å¡ç‰‡)
â”œâ”€â”€ SongFilters.tsx (ç¯©é¸æ§åˆ¶å€)
â”œâ”€â”€ SongActions.tsx (æ‰¹é‡æ“ä½œå·¥å…·åˆ—)
â”œâ”€â”€ SongEditModal.tsx (ç·¨è¼¯å½ˆçª—)
â””â”€â”€ hooks/
    â”œâ”€â”€ useSongList.ts (åˆ—è¡¨ç‹€æ…‹ç®¡ç†)
    â”œâ”€â”€ useSongFilters.ts (ç¯©é¸é‚è¼¯)
    â””â”€â”€ useSongActions.ts (æ“ä½œé‚è¼¯)
```

**æ‹†åˆ†ç¯„ä¾‹**ï¼š

```typescript
// components/SongCard.tsx
import { memo } from 'react';
import { Card, CardContent } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { TagBadge } from './TagBadge';

interface SongCardProps {
  song: Song;
  isSelected: boolean;
  onVote: (songId: string) => void;
  onEdit?: (song: Song) => void;
  onSelect?: (songId: string) => void;
}

// ä½¿ç”¨ React.memo å„ªåŒ–é‡æ¸²æŸ“
export const SongCard = memo<SongCardProps>(({ 
  song, 
  isSelected,
  onVote, 
  onEdit, 
  onSelect 
}) => {
  return (
    <Card className={isSelected ? 'ring-2 ring-primary' : ''}>
      <CardContent className="p-4">
        <div className="flex items-center justify-between">
          <div className="flex-1">
            <h3 className="font-semibold">{song.title}</h3>
            <p className="text-sm text-muted-foreground">{song.artist}</p>
          </div>
          <div className="flex items-center gap-2">
            <span className="text-lg font-bold">{song.votes}</span>
            <Button 
              variant="secondary" 
              size="sm"
              onClick={() => onVote(song.id)}
            >
              é»æ’­
            </Button>
          </div>
        </div>
        <div className="mt-2 flex flex-wrap gap-1">
          {song.tags?.map(tag => (
            <TagBadge key={tag.id} tag={tag} />
          ))}
        </div>
      </CardContent>
    </Card>
  );
}, (prevProps, nextProps) => {
  // è‡ªè¨‚æ¯”è¼ƒå‡½å¼ï¼Œå„ªåŒ–æ•ˆèƒ½
  return (
    prevProps.song.id === nextProps.song.id &&
    prevProps.song.votes === nextProps.song.votes &&
    prevProps.isSelected === nextProps.isSelected
  );
});

SongCard.displayName = 'SongCard';
```

---

### 5. ç¶²è·¯ç‹€æ…‹ç›£æ§

**å»ºè­°æ–°å¢ç¶²è·¯ç‹€æ…‹ Hook**ï¼š

```typescript
// client/src/hooks/use-network-status.ts
import { useState, useEffect, useCallback } from 'react';

interface NetworkStatus {
  isOnline: boolean;
  isSlowConnection: boolean;
  connectionType: string;
}

export function useNetworkStatus() {
  const [status, setStatus] = useState<NetworkStatus>({
    isOnline: navigator.onLine,
    isSlowConnection: false,
    connectionType: 'unknown',
  });

  const updateNetworkStatus = useCallback(() => {
    const connection = (navigator as any).connection;
    
    setStatus({
      isOnline: navigator.onLine,
      isSlowConnection: connection?.effectiveType === '2g' || 
                        connection?.effectiveType === 'slow-2g',
      connectionType: connection?.effectiveType || 'unknown',
    });
  }, []);

  useEffect(() => {
    window.addEventListener('online', updateNetworkStatus);
    window.addEventListener('offline', updateNetworkStatus);
    
    const connection = (navigator as any).connection;
    if (connection) {
      connection.addEventListener('change', updateNetworkStatus);
    }

    return () => {
      window.removeEventListener('online', updateNetworkStatus);
      window.removeEventListener('offline', updateNetworkStatus);
      if (connection) {
        connection.removeEventListener('change', updateNetworkStatus);
      }
    };
  }, [updateNetworkStatus]);

  return status;
}
```

**æ•´åˆè‡³ App**ï¼š

```typescript
// components/NetworkStatusBanner.tsx
import { useNetworkStatus } from '@/hooks/use-network-status';
import { WifiOff, AlertTriangle } from 'lucide-react';

export function NetworkStatusBanner() {
  const { isOnline, isSlowConnection } = useNetworkStatus();

  if (!isOnline) {
    return (
      <div className="fixed top-0 left-0 right-0 z-50 bg-red-500 text-white py-2 px-4 flex items-center justify-center gap-2">
        <WifiOff className="h-4 w-4" />
        <span>ç¶²è·¯é€£ç·šä¸­æ–·ï¼Œéƒ¨åˆ†åŠŸèƒ½ç„¡æ³•ä½¿ç”¨</span>
      </div>
    );
  }

  if (isSlowConnection) {
    return (
      <div className="fixed top-0 left-0 right-0 z-50 bg-yellow-500 text-black py-2 px-4 flex items-center justify-center gap-2">
        <AlertTriangle className="h-4 w-4" />
        <span>ç¶²è·¯é€£ç·šç·©æ…¢</span>
      </div>
    );
  }

  return null;
}
```

---

### 6. æ•ˆèƒ½ç›£æ§æ•´åˆ

**å»ºè­°ä½¿ç”¨ Firebase Performance**ï¼š

```typescript
// client/src/lib/performance.ts
import { getPerformance, trace } from 'firebase/performance';
import { app } from './firebase';

// åˆå§‹åŒ– Performance Monitoring
const perf = getPerformance(app);

// è‡ªè¨‚æ•ˆèƒ½è¿½è¹¤
export function createTrace(name: string) {
  return trace(perf, name);
}

// è¿½è¹¤é é¢è¼‰å…¥
export function trackPageLoad(pageName: string) {
  const pageTrace = createTrace(`page_load_${pageName}`);
  pageTrace.start();
  
  window.addEventListener('load', () => {
    pageTrace.stop();
  }, { once: true });
}

// è¿½è¹¤ API å‘¼å«
export async function trackApiCall<T>(
  name: string,
  fn: () => Promise<T>
): Promise<T> {
  const apiTrace = createTrace(`api_${name}`);
  apiTrace.start();
  
  try {
    const result = await fn();
    apiTrace.putAttribute('status', 'success');
    return result;
  } catch (error) {
    apiTrace.putAttribute('status', 'error');
    throw error;
  } finally {
    apiTrace.stop();
  }
}
```

---

## ğŸš€ ä¸­æœŸåŠŸèƒ½é–‹ç™¼ (2-4 é€±)

### 7. PWA é›¢ç·šæ”¯æ´å¯¦ä½œ

**å®‰è£ä¾è³´**ï¼š
```bash
npm install vite-plugin-pwa -D
```

**å®Œæ•´é…ç½®**ï¼š

```typescript
// vite.config.ts
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';
import { VitePWA } from 'vite-plugin-pwa';

export default defineConfig({
  plugins: [
    react(),
    VitePWA({
      registerType: 'autoUpdate',
      includeAssets: ['favicon.ico', 'apple-touch-icon.png', 'masked-icon.svg'],
      manifest: {
        name: 'äº’å‹•å¼å‰ä»–å½ˆå”±é»æ’­å¹³å°',
        short_name: 'é»æ­Œå¹³å°',
        description: 'å³æ™‚é»æ’­ã€æŠ•ç¥¨çš„å‰ä»–è¡¨æ¼”äº’å‹•å¹³å°',
        theme_color: '#f59e0b',
        background_color: '#000000',
        display: 'standalone',
        orientation: 'portrait',
        scope: '/song/',
        start_url: '/song/',
        icons: [
          {
            src: 'pwa-192x192.png',
            sizes: '192x192',
            type: 'image/png',
          },
          {
            src: 'pwa-512x512.png',
            sizes: '512x512',
            type: 'image/png',
            purpose: 'any maskable',
          },
        ],
      },
      workbox: {
        globPatterns: ['**/*.{js,css,html,ico,png,svg,woff,woff2}'],
        runtimeCaching: [
          {
            // å¿«å– Firebase SDK
            urlPattern: /^https:\/\/www\.gstatic\.com\/.*/i,
            handler: 'CacheFirst',
            options: {
              cacheName: 'firebase-sdk-cache',
              expiration: {
                maxEntries: 10,
                maxAgeSeconds: 60 * 60 * 24 * 30, // 30 å¤©
              },
            },
          },
          {
            // å¿«å– Google Fonts
            urlPattern: /^https:\/\/fonts\.googleapis\.com\/.*/i,
            handler: 'StaleWhileRevalidate',
            options: {
              cacheName: 'google-fonts-stylesheets',
            },
          },
          {
            urlPattern: /^https:\/\/fonts\.gstatic\.com\/.*/i,
            handler: 'CacheFirst',
            options: {
              cacheName: 'google-fonts-webfonts',
              expiration: {
                maxEntries: 30,
                maxAgeSeconds: 60 * 60 * 24 * 365, // 1 å¹´
              },
            },
          },
        ],
      },
    }),
  ],
});
```

**é›¢ç·šæ­Œå–®æª¢è¦–åŠŸèƒ½**ï¼š

```typescript
// client/src/lib/offline-cache.ts
import { openDB, DBSchema, IDBPDatabase } from 'idb';

interface SongDB extends DBSchema {
  songs: {
    key: string;
    value: Song;
    indexes: { 'by-votes': number };
  };
  lastSync: {
    key: 'timestamp';
    value: number;
  };
}

class OfflineCache {
  private db: IDBPDatabase<SongDB> | null = null;

  async init() {
    this.db = await openDB<SongDB>('song-cache', 1, {
      upgrade(db) {
        const songStore = db.createObjectStore('songs', { keyPath: 'id' });
        songStore.createIndex('by-votes', 'votes');
        db.createObjectStore('lastSync');
      },
    });
  }

  async cacheSongs(songs: Song[]) {
    if (!this.db) await this.init();
    const tx = this.db!.transaction('songs', 'readwrite');
    await Promise.all(songs.map(song => tx.store.put(song)));
    await tx.done;
    
    // è¨˜éŒ„åŒæ­¥æ™‚é–“
    await this.db!.put('lastSync', Date.now(), 'timestamp');
  }

  async getCachedSongs(): Promise<Song[]> {
    if (!this.db) await this.init();
    return this.db!.getAllFromIndex('songs', 'by-votes');
  }

  async getLastSyncTime(): Promise<number | undefined> {
    if (!this.db) await this.init();
    return this.db!.get('lastSync', 'timestamp');
  }
}

export const offlineCache = new OfflineCache();
```

---

### 8. æ­Œè©åŒæ­¥æ’­æ”¾åŠŸèƒ½

**è³‡æ–™çµæ§‹è¨­è¨ˆ**ï¼š

```typescript
// types/lyrics.ts
interface LyricLine {
  time: number;      // ç§’æ•¸
  text: string;      // æ­Œè©å…§å®¹
  translation?: string;  // ç¿»è­¯ (å¯é¸)
}

interface SongLyrics {
  songId: string;
  format: 'lrc' | 'plain';
  lines: LyricLine[];
  source?: string;    // æ­Œè©ä¾†æº
  contributor?: string;  // è²¢ç»è€…
}

// LRC æ ¼å¼è§£æå™¨
export function parseLRC(lrcText: string): LyricLine[] {
  const lines: LyricLine[] = [];
  const regex = /\[(\d{2}):(\d{2})(?:\.(\d{2,3}))?\](.*)/g;
  
  let match;
  while ((match = regex.exec(lrcText)) !== null) {
    const minutes = parseInt(match[1], 10);
    const seconds = parseInt(match[2], 10);
    const milliseconds = match[3] ? parseInt(match[3].padEnd(3, '0'), 10) : 0;
    
    lines.push({
      time: minutes * 60 + seconds + milliseconds / 1000,
      text: match[4].trim(),
    });
  }
  
  return lines.sort((a, b) => a.time - b.time);
}
```

**æ­Œè©æ’­æ”¾å™¨å…ƒä»¶**ï¼š

```typescript
// components/LyricsPlayer.tsx
import { useState, useEffect, useRef } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { LyricLine } from '@/types/lyrics';

interface LyricsPlayerProps {
  lyrics: LyricLine[];
  currentTime: number;  // å¾éŸ³é »æ’­æ”¾å™¨åŒæ­¥
}

export function LyricsPlayer({ lyrics, currentTime }: LyricsPlayerProps) {
  const [currentIndex, setCurrentIndex] = useState(0);
  const containerRef = useRef<HTMLDivElement>(null);

  useEffect(() => {
    const index = lyrics.findIndex((line, i) => {
      const nextLine = lyrics[i + 1];
      return currentTime >= line.time && 
             (!nextLine || currentTime < nextLine.time);
    });
    
    if (index !== -1 && index !== currentIndex) {
      setCurrentIndex(index);
    }
  }, [currentTime, lyrics, currentIndex]);

  // è‡ªå‹•æ»¾å‹•åˆ°ç•¶å‰æ­Œè©
  useEffect(() => {
    const container = containerRef.current;
    if (container) {
      const currentElement = container.children[currentIndex] as HTMLElement;
      if (currentElement) {
        currentElement.scrollIntoView({ 
          behavior: 'smooth', 
          block: 'center' 
        });
      }
    }
  }, [currentIndex]);

  return (
    <div 
      ref={containerRef}
      className="h-64 overflow-y-auto scrollbar-hide"
    >
      {lyrics.map((line, index) => (
        <motion.p
          key={`${line.time}-${index}`}
          className={`py-2 px-4 text-center transition-all duration-300 ${
            index === currentIndex
              ? 'text-xl font-bold text-primary'
              : 'text-muted-foreground'
          }`}
          initial={{ opacity: 0.5, scale: 0.95 }}
          animate={{
            opacity: index === currentIndex ? 1 : 0.5,
            scale: index === currentIndex ? 1 : 0.95,
          }}
        >
          {line.text}
        </motion.p>
      ))}
    </div>
  );
}
```

---

### 9. çµ±è¨ˆå„€è¡¨æ¿é–‹ç™¼

**è³‡æ–™æ”¶é›†çµæ§‹**ï¼š

```typescript
// lib/analytics.ts
import { 
  collection, 
  doc, 
  setDoc, 
  increment, 
  serverTimestamp 
} from 'firebase/firestore';
import { db } from './firebase';

// è¨˜éŒ„é»æ’­äº‹ä»¶
export async function logVoteEvent(songId: string, songTitle: string) {
  const today = new Date().toISOString().split('T')[0];
  const hour = new Date().getHours().toString();
  
  // æ›´æ–°æ¯æ—¥çµ±è¨ˆ
  const dailyRef = doc(db, 'stats', today);
  await setDoc(dailyRef, {
    totalVotes: increment(1),
    lastUpdated: serverTimestamp(),
    [`hourly.${hour}`]: increment(1),
    [`songs.${songId}`]: increment(1),
  }, { merge: true });
}

// å–å¾—çµ±è¨ˆæ•¸æ“š
export async function getStats(days: number = 7) {
  const stats: DailyStats[] = [];
  const today = new Date();
  
  for (let i = 0; i < days; i++) {
    const date = new Date(today);
    date.setDate(date.getDate() - i);
    const dateStr = date.toISOString().split('T')[0];
    
    const docRef = doc(db, 'stats', dateStr);
    const docSnap = await getDoc(docRef);
    
    if (docSnap.exists()) {
      stats.push({
        date: dateStr,
        ...docSnap.data() as Omit<DailyStats, 'date'>,
      });
    }
  }
  
  return stats;
}
```

**å„€è¡¨æ¿å…ƒä»¶å»ºè­°**ï¼š

```
StatsDashboard/
â”œâ”€â”€ index.tsx (ä¸»é é¢)
â”œâ”€â”€ TrendChart.tsx (è¶¨å‹¢æŠ˜ç·šåœ– - ä½¿ç”¨ recharts)
â”œâ”€â”€ HourlyHeatmap.tsx (æ™‚æ®µç†±åŠ›åœ–)
â”œâ”€â”€ TopSongsChart.tsx (ç†±é–€æ­Œæ›²é•·æ¢åœ–)
â”œâ”€â”€ QuickStats.tsx (å¿«é€Ÿçµ±è¨ˆå¡ç‰‡)
â””â”€â”€ hooks/
    â””â”€â”€ useStats.ts (çµ±è¨ˆæ•¸æ“š Hook)
```

---

## ğŸŒŸ é•·æœŸé€²éšç™¼å±• (1-3 å€‹æœˆ)

### 10. å¤šèªç³»æ”¯æ´ (i18n)

**å®‰è£ä¾è³´**ï¼š
```bash
npm install react-i18next i18next i18next-browser-languagedetector
```

**åŸºç¤è¨­ç½®**ï¼š

```typescript
// lib/i18n.ts
import i18n from 'i18next';
import { initReactI18next } from 'react-i18next';
import LanguageDetector from 'i18next-browser-languagedetector';

// ç¿»è­¯è³‡æº
const resources = {
  'zh-TW': {
    translation: {
      common: {
        vote: 'é»æ’­',
        songs: 'æ­Œæ›²',
        ranking: 'æ’è¡Œæ¦œ',
        suggest: 'å»ºè­°æ­Œæ›²',
        admin: 'ç®¡ç†å“¡',
        login: 'ç™»å…¥',
        logout: 'ç™»å‡º',
        search: 'æœå°‹',
        loading: 'è¼‰å…¥ä¸­...',
        error: 'ç™¼ç”ŸéŒ¯èª¤',
        retry: 'é‡è©¦',
        save: 'å„²å­˜',
        cancel: 'å–æ¶ˆ',
        delete: 'åˆªé™¤',
        edit: 'ç·¨è¼¯',
        confirm: 'ç¢ºèª',
      },
      song: {
        title: 'æ­Œæ›²åç¨±',
        artist: 'æ­Œæ‰‹/æ¼”å”±è€…',
        votes: 'é»æ’­æ¬¡æ•¸',
        tags: 'æ¨™ç±¤',
        addSuccess: 'æ­Œæ›²æ–°å¢æˆåŠŸï¼',
        voteSuccess: 'é»æ’­æˆåŠŸï¼',
        voteCooldown: 'è«‹ç¨å€™ {{seconds}} ç§’å¾Œå†é»æ’­',
      },
      ranking: {
        top: 'æ’è¡Œæ¦œ TOP',
        noSongs: 'ç›®å‰æ²’æœ‰æ­Œæ›²',
        refresh: 'é‡æ–°æ•´ç†',
      },
      // ... æ›´å¤šç¿»è­¯
    },
  },
  en: {
    translation: {
      common: {
        vote: 'Vote',
        songs: 'Songs',
        ranking: 'Ranking',
        suggest: 'Suggest Song',
        admin: 'Admin',
        login: 'Login',
        logout: 'Logout',
        search: 'Search',
        loading: 'Loading...',
        error: 'Error occurred',
        retry: 'Retry',
        save: 'Save',
        cancel: 'Cancel',
        delete: 'Delete',
        edit: 'Edit',
        confirm: 'Confirm',
      },
      song: {
        title: 'Song Title',
        artist: 'Artist',
        votes: 'Votes',
        tags: 'Tags',
        addSuccess: 'Song added successfully!',
        voteSuccess: 'Vote submitted!',
        voteCooldown: 'Please wait {{seconds}} seconds',
      },
      ranking: {
        top: 'TOP Ranking',
        noSongs: 'No songs available',
        refresh: 'Refresh',
      },
    },
  },
  ja: {
    translation: {
      common: {
        vote: 'ãƒªã‚¯ã‚¨ã‚¹ãƒˆ',
        songs: 'æ›²ãƒªã‚¹ãƒˆ',
        ranking: 'ãƒ©ãƒ³ã‚­ãƒ³ã‚°',
        suggest: 'æ›²ã‚’ææ¡ˆ',
        admin: 'ç®¡ç†è€…',
        login: 'ãƒ­ã‚°ã‚¤ãƒ³',
        logout: 'ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ',
        search: 'æ¤œç´¢',
        loading: 'èª­ã¿è¾¼ã¿ä¸­...',
      },
      // ... å…¶ä»–ç¿»è­¯
    },
  },
};

i18n
  .use(LanguageDetector)
  .use(initReactI18next)
  .init({
    resources,
    fallbackLng: 'zh-TW',
    interpolation: {
      escapeValue: false,
    },
  });

export default i18n;
```

**èªè¨€åˆ‡æ›å…ƒä»¶**ï¼š

```typescript
// components/LanguageSwitcher.tsx
import { useTranslation } from 'react-i18next';
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from '@/components/ui/select';

const LANGUAGES = [
  { code: 'zh-TW', label: 'ç¹é«”ä¸­æ–‡', flag: 'ğŸ‡¹ğŸ‡¼' },
  { code: 'en', label: 'English', flag: 'ğŸ‡ºğŸ‡¸' },
  { code: 'ja', label: 'æ—¥æœ¬èª', flag: 'ğŸ‡¯ğŸ‡µ' },
];

export function LanguageSwitcher() {
  const { i18n } = useTranslation();

  return (
    <Select value={i18n.language} onValueChange={i18n.changeLanguage}>
      <SelectTrigger className="w-[140px]">
        <SelectValue />
      </SelectTrigger>
      <SelectContent>
        {LANGUAGES.map(({ code, label, flag }) => (
          <SelectItem key={code} value={code}>
            <span className="flex items-center gap-2">
              <span>{flag}</span>
              <span>{label}</span>
            </span>
          </SelectItem>
        ))}
      </SelectContent>
    </Select>
  );
}
```

---

### 11. é€²éšæ¨æ’­é€šçŸ¥ç³»çµ±

**Firebase Cloud Messaging è¨­å®š**ï¼š

```typescript
// lib/messaging.ts
import { getMessaging, getToken, onMessage } from 'firebase/messaging';
import { app } from './firebase';

const messaging = getMessaging(app);

// è«‹æ±‚é€šçŸ¥æ¬Šé™ä¸¦å–å¾— Token
export async function requestNotificationPermission(): Promise<string | null> {
  try {
    const permission = await Notification.requestPermission();
    
    if (permission === 'granted') {
      const token = await getToken(messaging, {
        vapidKey: import.meta.env.VITE_FIREBASE_VAPID_KEY,
      });
      
      // å„²å­˜ token åˆ° Firestore ä¾›å¾Œç«¯ä½¿ç”¨
      await saveUserToken(token);
      
      return token;
    }
    
    return null;
  } catch (error) {
    console.error('Error getting notification token:', error);
    return null;
  }
}

// å‰æ™¯è¨Šæ¯è™•ç†
export function setupForegroundMessageHandler() {
  onMessage(messaging, (payload) => {
    console.log('Received foreground message', payload);
    
    // é¡¯ç¤ºæœ¬åœ°é€šçŸ¥
    if (payload.notification) {
      new Notification(payload.notification.title || 'æ–°é€šçŸ¥', {
        body: payload.notification.body,
        icon: '/pwa-192x192.png',
      });
    }
  });
}

// é€šçŸ¥é¡å‹å®šç¾©
type NotificationType = 
  | 'song_trending'    // æ­Œæ›²é€²å…¥æ’è¡Œæ¦œå‰ 3
  | 'suggestion_approved'  // å»ºè­°è¢«æ¡ç´
  | 'new_song_added'   // æ–°æ­Œæ›²ä¸Šæ¶
  | 'event_starting';  // æ´»å‹•å³å°‡é–‹å§‹
```

---

### 12. A/B æ¸¬è©¦æ¡†æ¶

```typescript
// lib/experiments.ts
import { doc, getDoc, setDoc } from 'firebase/firestore';
import { db } from './firebase';

interface Experiment {
  id: string;
  name: string;
  variants: string[];
  weights?: number[];
  enabled: boolean;
}

class ExperimentManager {
  private experiments: Map<string, string> = new Map();
  private userId: string;

  constructor(userId: string) {
    this.userId = userId;
    this.loadExperiments();
  }

  private async loadExperiments() {
    // å¾ Firestore æˆ– localStorage è¼‰å…¥ä½¿ç”¨è€…å·²åˆ†é…çš„å¯¦é©—
    const cached = localStorage.getItem(`experiments_${this.userId}`);
    if (cached) {
      const data = JSON.parse(cached);
      Object.entries(data).forEach(([key, value]) => {
        this.experiments.set(key, value as string);
      });
    }
  }

  async getVariant(experimentId: string): Promise<string> {
    // æª¢æŸ¥æ˜¯å¦å·²åˆ†é…
    if (this.experiments.has(experimentId)) {
      return this.experiments.get(experimentId)!;
    }

    // å¾ Firestore å–å¾—å¯¦é©—é…ç½®
    const expDoc = await getDoc(doc(db, 'experiments', experimentId));
    if (!expDoc.exists() || !expDoc.data().enabled) {
      return 'control';
    }

    const { variants, weights } = expDoc.data() as Experiment;
    
    // åŠ æ¬Šéš¨æ©Ÿåˆ†é…
    const variant = this.weightedRandom(variants, weights);
    
    // å„²å­˜åˆ†é…çµæœ
    this.experiments.set(experimentId, variant);
    this.saveExperiments();
    
    // è¨˜éŒ„åˆ° Firestore
    await this.logAssignment(experimentId, variant);
    
    return variant;
  }

  private weightedRandom(variants: string[], weights?: number[]): string {
    if (!weights) {
      return variants[Math.floor(Math.random() * variants.length)];
    }

    const totalWeight = weights.reduce((a, b) => a + b, 0);
    let random = Math.random() * totalWeight;
    
    for (let i = 0; i < variants.length; i++) {
      random -= weights[i];
      if (random <= 0) return variants[i];
    }
    
    return variants[variants.length - 1];
  }

  private saveExperiments() {
    localStorage.setItem(
      `experiments_${this.userId}`,
      JSON.stringify(Object.fromEntries(this.experiments))
    );
  }

  private async logAssignment(experimentId: string, variant: string) {
    await setDoc(
      doc(db, 'experimentAssignments', `${this.userId}_${experimentId}`),
      {
        userId: this.userId,
        experimentId,
        variant,
        assignedAt: new Date(),
      }
    );
  }
}

// ä½¿ç”¨ç¯„ä¾‹
// const expManager = new ExperimentManager(userId);
// const buttonVariant = await expManager.getVariant('vote_button_style');
// if (buttonVariant === 'animated') { ... }
```

---

## ğŸ“¦ ç¨‹å¼ç¢¼å“è³ªæå‡

### 13. ESLint + Prettier è¨­å®š

```bash
npm install -D eslint prettier eslint-config-prettier eslint-plugin-react-hooks @typescript-eslint/eslint-plugin @typescript-eslint/parser
```

```javascript
// .eslintrc.cjs
module.exports = {
  root: true,
  env: { browser: true, es2020: true },
  extends: [
    'eslint:recommended',
    'plugin:@typescript-eslint/recommended',
    'plugin:react-hooks/recommended',
    'prettier',
  ],
  ignorePatterns: ['dist', '.eslintrc.cjs'],
  parser: '@typescript-eslint/parser',
  plugins: ['react-refresh'],
  rules: {
    'react-refresh/only-export-components': [
      'warn',
      { allowConstantExport: true },
    ],
    '@typescript-eslint/no-explicit-any': 'warn',
    '@typescript-eslint/no-unused-vars': ['warn', { argsIgnorePattern: '^_' }],
    'no-console': ['warn', { allow: ['warn', 'error'] }],
  },
};
```

```json
// .prettierrc
{
  "semi": true,
  "trailingComma": "es5",
  "singleQuote": true,
  "printWidth": 80,
  "tabWidth": 2,
  "useTabs": false
}
```

### 14. Pre-commit Hooks (Husky + lint-staged)

```bash
npm install -D husky lint-staged
npx husky init
```

```json
// package.json
{
  "lint-staged": {
    "*.{ts,tsx}": [
      "eslint --fix",
      "prettier --write"
    ],
    "*.{css,json,md}": [
      "prettier --write"
    ]
  }
}
```

```bash
# .husky/pre-commit
npm run lint-staged
npm run check
```

### 15. å–®å…ƒæ¸¬è©¦è¨­ç½®

```bash
npm install -D vitest @testing-library/react @testing-library/jest-dom jsdom @testing-library/user-event
```

```typescript
// vite.config.ts - æ–°å¢æ¸¬è©¦é…ç½®
export default defineConfig({
  // ... å…¶ä»–é…ç½®
  test: {
    globals: true,
    environment: 'jsdom',
    setupFiles: './src/test/setup.ts',
    coverage: {
      provider: 'v8',
      reporter: ['text', 'json', 'html'],
    },
  },
});
```

```typescript
// client/src/test/setup.ts
import '@testing-library/jest-dom';
import { vi } from 'vitest';

// Mock Firebase
vi.mock('@/lib/firebase', () => ({
  db: {},
  auth: {},
  app: {},
}));
```

**æ¸¬è©¦ç¯„ä¾‹**ï¼š

```typescript
// client/src/components/__tests__/SongCard.test.tsx
import { render, screen, fireEvent } from '@testing-library/react';
import { describe, it, expect, vi } from 'vitest';
import { SongCard } from '../SongCard';

const mockSong = {
  id: '1',
  title: 'å‘Šç™½æ°£çƒ',
  artist: 'å‘¨æ°å€«',
  votes: 10,
  tags: [],
};

describe('SongCard', () => {
  it('renders song title and artist', () => {
    render(
      <SongCard 
        song={mockSong} 
        isSelected={false}
        onVote={vi.fn()} 
      />
    );
    
    expect(screen.getByText('å‘Šç™½æ°£çƒ')).toBeInTheDocument();
    expect(screen.getByText('å‘¨æ°å€«')).toBeInTheDocument();
  });

  it('calls onVote when vote button is clicked', () => {
    const mockOnVote = vi.fn();
    render(
      <SongCard 
        song={mockSong}
        isSelected={false}
        onVote={mockOnVote} 
      />
    );
    
    fireEvent.click(screen.getByRole('button', { name: /é»æ’­/i }));
    expect(mockOnVote).toHaveBeenCalledWith('1');
  });

  it('shows selected state correctly', () => {
    const { container } = render(
      <SongCard 
        song={mockSong}
        isSelected={true}
        onVote={vi.fn()} 
      />
    );
    
    expect(container.querySelector('.ring-primary')).toBeInTheDocument();
  });
});
```

---

## âš¡ æ•ˆèƒ½å„ªåŒ–ç­–ç•¥

### 16. ç¨‹å¼ç¢¼åˆ†å‰²

```typescript
// App.tsx ä½¿ç”¨ React.lazy
import { lazy, Suspense } from 'react';
import { LoadingSpinner } from '@/components/ui/loading-spinner';

// å»¶é²è¼‰å…¥è¼ƒå¤§çš„å…ƒä»¶
const RankingBoard = lazy(() => import('./components/RankingBoard'));
const SongSuggestion = lazy(() => import('./components/SongSuggestion'));
const MusicPlayer = lazy(() => import('./components/MusicPlayer'));
const StatsDashboard = lazy(() => import('./components/StatsDashboard'));

function App() {
  return (
    <Suspense fallback={<LoadingSpinner />}>
      {/* å…ƒä»¶ä½¿ç”¨ */}
    </Suspense>
  );
}
```

### 17. åœ–ç‰‡å„ªåŒ–ç­–ç•¥

```typescript
// components/OptimizedImage.tsx
interface OptimizedImageProps {
  src: string;
  alt: string;
  width?: number;
  height?: number;
  className?: string;
}

export function OptimizedImage({ 
  src, 
  alt, 
  width, 
  height, 
  className 
}: OptimizedImageProps) {
  return (
    <img
      src={src}
      alt={alt}
      width={width}
      height={height}
      loading="lazy"
      decoding="async"
      className={className}
      onError={(e) => {
        // è¼‰å…¥å¤±æ•—æ™‚é¡¯ç¤ºé è¨­åœ–
        (e.target as HTMLImageElement).src = '/placeholder.png';
      }}
    />
  );
}
```

### 18. Firestore æŸ¥è©¢å„ªåŒ–

```typescript
// lib/firestore-optimized.ts
import { 
  collection, 
  query, 
  orderBy, 
  limit, 
  startAfter,
  getDocs,
  DocumentData,
  QueryDocumentSnapshot
} from 'firebase/firestore';
import { db } from './firebase';

interface PaginatedResult<T> {
  items: T[];
  lastDoc: QueryDocumentSnapshot<DocumentData> | null;
  hasMore: boolean;
}

// åˆ†é è¼‰å…¥æ­Œæ›²
export async function getSongsPaginated(
  pageSize: number = 20,
  lastDocument?: QueryDocumentSnapshot<DocumentData>
): Promise<PaginatedResult<Song>> {
  let q = query(
    collection(db, 'songs'),
    orderBy('votes', 'desc'),
    limit(pageSize + 1)  // å¤šå–ä¸€ç­†åˆ¤æ–·æ˜¯å¦é‚„æœ‰æ›´å¤š
  );

  if (lastDocument) {
    q = query(q, startAfter(lastDocument));
  }

  const snapshot = await getDocs(q);
  const docs = snapshot.docs;
  const hasMore = docs.length > pageSize;
  
  // å¦‚æœæœ‰å¤šé¤˜çš„ï¼Œç§»é™¤æœ€å¾Œä¸€ç­†
  const items = docs.slice(0, pageSize).map(doc => ({
    id: doc.id,
    ...doc.data(),
  } as Song));

  return {
    items,
    lastDoc: docs.length > 0 ? docs[docs.length - 1] : null,
    hasMore,
  };
}
```

---

## ğŸš¢ éƒ¨ç½²èˆ‡ç¶­é‹å»ºè­°

### 19. CI/CD å¢å¼·

```yaml
# .github/workflows/ci.yml
name: CI

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'
      
      - name: Install dependencies
        run: npm ci
      
      - name: Type check
        run: npm run check
      
      - name: Lint
        run: npm run lint
      
      - name: Run tests
        run: npm run test:coverage
      
      - name: Upload coverage
        uses: codecov/codecov-action@v3
        with:
          files: ./coverage/lcov.info

  build:
    needs: test
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'
      
      - name: Install dependencies
        run: npm ci
      
      - name: Build
        run: npm run build
        env:
          VITE_FIREBASE_API_KEY: ${{ secrets.VITE_FIREBASE_API_KEY }}
          # ... å…¶ä»–ç’°å¢ƒè®Šæ•¸
      
      - name: Upload build artifacts
        uses: actions/upload-artifact@v4
        with:
          name: dist
          path: dist/
```

### 20. ç›£æ§èˆ‡å‘Šè­¦

**å»ºè­°æ•´åˆä»¥ä¸‹å·¥å…·**ï¼š

| å·¥å…· | ç”¨é€” | æˆæœ¬ |
|------|------|------|
| Firebase Analytics | ä½¿ç”¨è€…è¡Œç‚ºåˆ†æ | å…è²» |
| Firebase Performance | æ•ˆèƒ½ç›£æ§ | å…è²» |
| Firebase Crashlytics | éŒ¯èª¤è¿½è¹¤ | å…è²» |
| Sentry | é€²éšéŒ¯èª¤è¿½è¹¤ | å…è²»æ–¹æ¡ˆå¯ç”¨ |
| Uptime Robot | å¯ç”¨æ€§ç›£æ§ | å…è²» |

---

## ğŸ’° å•†æ¥­åŒ–æ–¹å‘æ¢ç´¢

### 21. æ½›åœ¨å•†æ¥­æ¨¡å¼

| æ¨¡å¼ | èªªæ˜ | å¯è¡Œæ€§ |
|------|------|--------|
| **è¨‚é–±åˆ¶** | æœˆè²»è§£é–é€²éšåŠŸèƒ½ | â­â­â­ |
| **æ‰“è³åŠŸèƒ½** | è§€çœ¾æ‰“è³è¡¨æ¼”è€… | â­â­â­â­ |
| **æ´»å‹•åŒ…å ´** | B2B æ´»å‹•å ´åœ°ç§Ÿå€Ÿ | â­â­â­ |
| **å»£å‘Šæ”¶å…¥** | æ­Œæ›²é–“æ’æ’­å»£å‘Š | â­â­ |
| **ç¡¬é«”æ•´åˆ** | è²©å”®å°ˆç”¨æŠ•å½±/è§¸æ§è¨­å‚™ | â­ |

### 22. VIP æœƒå“¡åŠŸèƒ½è¦åŠƒ

```typescript
// types/membership.ts
interface MembershipTier {
  id: 'free' | 'basic' | 'premium';
  name: string;
  price: number;  // æœˆè²» (TWD)
  features: string[];
}

const MEMBERSHIP_TIERS: MembershipTier[] = [
  {
    id: 'free',
    name: 'å…è²»æœƒå“¡',
    price: 0,
    features: [
      'æ¯æ—¥ 10 æ¬¡é»æ’­',
      'åŸºæœ¬æ’è¡Œæ¦œæŸ¥çœ‹',
      'æ­Œæ›²å»ºè­°åŠŸèƒ½',
    ],
  },
  {
    id: 'basic',
    name: 'åŸºæœ¬æœƒå“¡',
    price: 99,
    features: [
      'ç„¡é™æ¬¡é»æ’­',
      'å„ªå…ˆé»æ’­æ¬Š',
      'é»æ’­æ­·å²è¨˜éŒ„',
      'å°ˆå±¬æœƒå“¡å¾½ç« ',
      'å»é™¤å»£å‘Š',
    ],
  },
  {
    id: 'premium',
    name: 'å°Šæ¦®æœƒå“¡',
    price: 299,
    features: [
      'æ‰€æœ‰åŸºæœ¬æœƒå“¡åŠŸèƒ½',
      'è¶…ç´šå„ªå…ˆé»æ’­æ¬Š',
      'å°ˆå±¬æ­Œå–®å»ºç«‹',
      'é›¢ç·šæ­Œè©æŸ¥çœ‹',
      'å°ˆå±¬å®¢æœæ”¯æ´',
      'æ¯æœˆè´ˆé€é»æ•¸',
    ],
  },
];
```

---

## ğŸ“š å­¸ç¿’è³‡æºèˆ‡åƒè€ƒ

### æ¨è–¦å­¸ç¿’è³‡æº

| ä¸»é¡Œ | è³‡æº | èªªæ˜ |
|------|------|------|
| TypeScript | [TypeScript Handbook](https://www.typescriptlang.org/docs/handbook/) | å®˜æ–¹æ•™å­¸ |
| React Patterns | [Patterns.dev](https://patterns.dev/) | ç¾ä»£è¨­è¨ˆæ¨¡å¼ |
| Firebase | [Firebase Documentation](https://firebase.google.com/docs) | å®˜æ–¹æ–‡ä»¶ |
| PWA | [web.dev PWA](https://web.dev/progressive-web-apps/) | Google æ•™å­¸ |
| æ•ˆèƒ½å„ªåŒ– | [Web Vitals](https://web.dev/vitals/) | æ ¸å¿ƒæŒ‡æ¨™ |
| æ¸¬è©¦ | [Testing Library](https://testing-library.com/) | æ¸¬è©¦æœ€ä½³å¯¦è¸ |

### ç›¸é—œæŠ€è¡“ç¤¾ç¾¤

- [React Taiwan](https://www.facebook.com/groups/reactjs.tw/)
- [Firebase Taiwan](https://www.facebook.com/groups/firebase.tw/)
- [TypeScript Taiwan](https://discord.gg/typescript-tw)

---

## ğŸ“ é™„éŒ„ï¼šæª¢æŸ¥æ¸…å–®

### é–‹ç™¼å‰æª¢æŸ¥

- [ ] å·²é–±è®€ç›¸é—œæ–‡ä»¶ (`README.md`, `DEVELOPMENT_ROADMAP.md`)
- [ ] å·²å–å¾— Firebase å°ˆæ¡ˆå­˜å–æ¬Šé™
- [ ] å·²è¨­å®šæœ¬åœ°é–‹ç™¼ç’°å¢ƒ
- [ ] å·²ç†è§£ç¾æœ‰æ¶æ§‹å’Œç¨‹å¼ç¢¼é¢¨æ ¼

### åŠŸèƒ½é–‹ç™¼æª¢æŸ¥

- [ ] å·²å»ºç«‹å°æ‡‰çš„ TypeScript å‹åˆ¥
- [ ] å·²è™•ç†éŒ¯èª¤æƒ…æ³ä¸¦æä¾›å‹å–„è¨Šæ¯
- [ ] å·²è€ƒæ…®è¼‰å…¥ç‹€æ…‹å’Œéª¨æ¶å±
- [ ] å·²å¯¦ä½œéŸ¿æ‡‰å¼è¨­è¨ˆ
- [ ] å·²æ·»åŠ å¿…è¦çš„å–®å…ƒæ¸¬è©¦
- [ ] å·²æ›´æ–°ç›¸é—œæ–‡ä»¶

### éƒ¨ç½²å‰æª¢æŸ¥

- [ ] TypeScript ç·¨è­¯ç„¡éŒ¯èª¤ (`npm run check`)
- [ ] æ‰€æœ‰æ¸¬è©¦é€šé (`npm run test`)
- [ ] ESLint ç„¡è­¦å‘Š (`npm run lint`)
- [ ] å»ºç½®æˆåŠŸ (`npm run build`)
- [ ] æœ¬åœ°é è¦½æ­£å¸¸ (`npm run preview`)

---

*æ­¤æ–‡ä»¶å°‡æŒçºŒæ›´æ–°ï¼Œæ­¡è¿æå‡ºå»ºè­°èˆ‡æ„è¦‹ï¼*  
*æœ€å¾Œæ›´æ–°ï¼š2026-01-13*

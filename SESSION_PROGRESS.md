# é–‹ç™¼é€²åº¦è¨˜éŒ„

**æœ€å¾Œæ›´æ–°æ™‚é–“**ï¼š2026-01-15 10:49 (UTC+8)

---

## âœ… æœ¬æ¬¡æœƒè©±å®Œæˆçš„åŠŸèƒ½

### 1. ç®¡ç†å“¡å½ˆå¥æ¨™è¨˜åŠŸèƒ½ â­ æ–°åŠŸèƒ½

**åŠŸèƒ½èªªæ˜**ï¼šç®¡ç†å“¡å¯åœ¨æ­Œæ›²æ’è¡Œæ¦œä¸­æ¨™è¨˜æ­Œæ›²ç‚ºã€Œå·²å½ˆå¥ã€ï¼Œç‹€æ…‹å³æ™‚åŒæ­¥åˆ°æ‰€æœ‰è¨ªå®¢è£ç½®ã€‚

**ä¿®æ”¹æª”æ¡ˆ**ï¼š
| æª”æ¡ˆ | è®Šæ›´ |
|------|------|
| `client/src/lib/firebase.ts` | æ–°å¢ `playedSongs` collection |
| `client/src/lib/firestore.ts` | `Song` åŠ å…¥ `isPlayed` æ¬„ä½ã€æ–°å¢ `markSongAsPlayed`/`unmarkSongAsPlayed`/`resetAllPlayedSongs` APIã€`subscribeSongs` ç›£è½ playedSongs |
| `client/src/components/RankingBoard/RankingBoard.tsx` | æ–°å¢ user propã€å½ˆå¥æ¨™è¨˜æŒ‰éˆ•ã€é‡ç½®æŒ‰éˆ•ã€å·²å½ˆå¥è¦–è¦ºæ•ˆæœ |
| `client/src/pages/Home.tsx` | å‚³é user prop çµ¦ RankingBoard |
| `firestore.rules` | æ–°å¢ `playedSongs` collection å®‰å…¨è¦å‰‡ï¼ˆå·²éƒ¨ç½²ï¼‰ |

**ä½¿ç”¨æ–¹å¼**ï¼š
- ç®¡ç†å“¡é»æ“Šæ­Œæ›²å³å´ âœ“ æŒ‰éˆ•æ¨™è¨˜å·²å½ˆå¥
- å†æ¬¡é»æ“Šå–æ¶ˆæ¨™è¨˜
- æ¨™é¡Œå€ã€Œé‡ç½®ã€æŒ‰éˆ•æ¸…é™¤æ‰€æœ‰æ¨™è¨˜

---

### 2. äººæ°£æ’è¡Œæ¦œè‡ªå‹•å±•é–‹

**åŠŸèƒ½èªªæ˜**ï¼šæ»¾å‹•åˆ°æ’è¡Œæ¦œåº•éƒ¨æ™‚è‡ªå‹•å±•é–‹é¡¯ç¤ºæ›´å¤šæ­Œæ›²ï¼ˆå‰ 30 åï¼‰ã€‚

**ä¿®æ”¹æª”æ¡ˆ**ï¼š
- `client/src/components/RankingBoard/RankingBoard.tsx`
  - æ–°å¢ `useEffect` å’Œ Intersection Observer
  - æ–°å¢ `loadMoreRef` å“¨å…µå…ƒç´ 
  - å±•é–‹å¾Œé¡¯ç¤ºã€Œæ”¶åˆæ’è¡Œæ¦œã€æŒ‰éˆ•

---

### 3. å·²å½ˆå¥æ­Œæ›²è¦–è¦ºå„ªåŒ–

**åŠŸèƒ½èªªæ˜**ï¼šå·²å½ˆå¥æ­Œæ›²é¡¯ç¤ºæ¸…æ™°çš„ã€Œâœ“ å·²å®Œæˆã€æ¨™ç±¤ã€‚

**è¦–è¦ºæ•ˆæœ**ï¼š
| åŸæœ¬ | ç¾åœ¨ |
|------|------|
| åˆªé™¤ç·š + ç°è‰²æ–‡å­— + åŠé€æ˜ | æ­£å¸¸é¡¯ç¤ºæ­Œåå’Œæ­Œæ‰‹ |
| åœ“å½¢å‹¾é¸ icon | ç¶ è‰²ã€Œâœ“ å·²å®Œæˆã€åœ“è§’æ¨™ç±¤ |
| ä¸æ˜“è¾¨è­˜ | æ·¡ç¶ è‰²èƒŒæ™¯ (`bg-emerald-50/50`) |

---

### 4. äººæ°£æ’è¡Œæ¦œ UI ç²¾ç°¡

**ä¿®æ”¹æª”æ¡ˆ**ï¼š
- `client/src/components/RankingBoard/RankingHeader.tsx`
  - ç§»é™¤å¤šé¤˜ç«ç„°åœ–æ¨™ã€èƒŒæ™¯è£é£¾
  - æ”¹ç”¨çç›ƒæ–¹å¡Š + æ¨™é¡Œçš„æ¥µç°¡è¨­è¨ˆ
- `client/src/components/RankingBoard/RankingBoard.tsx`
  - åˆ—è¡¨é–“è· `space-y-4` â†’ `space-y-2`
  - æ“ä½œæŒ‰éˆ•æ”¹ç”¨ `ghost` variant
  - ç¥¨æ•¸å€å¡Šçµ±ä¸€æ¨£å¼

---

### 5. å…¶ä»– UI å„ªåŒ–ï¼ˆå…ˆå‰å®Œæˆï¼‰

- **SearchBar**ï¼šç§»é™¤ blur æ•ˆæœå’Œ emoji è£é£¾
- **SongCard**ï¼šç°¡åŒ–è¨­è¨ˆã€ä¿æŒå·¦å´å½©è‰²é‚Šæ¡†
- **ScrollToTop**ï¼šç¥ç€è‰²æ¼¸å±¤ã€æ›´æ˜é¡¯çš„æ¨£å¼
- **ResetDialog**ï¼šæ·»åŠ è­¦å‘Šåœ–æ¨™ã€ç´…è‰²ç¢ºèªæŒ‰éˆ•

---

## ğŸ“ å°ˆæ¡ˆçµæ§‹é‡é»æª”æ¡ˆ

```
h:\song\
â”œâ”€â”€ client/src/
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ firebase.ts      # Firebase è¨­å®š + collection åç¨±
â”‚   â”‚   â”œâ”€â”€ firestore.ts     # Firestore APIï¼ˆå« playedSongsï¼‰
â”‚   â”‚   â””â”€â”€ auth.ts          # èªè­‰ç›¸é—œ
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ RankingBoard/
â”‚   â”‚   â”‚   â”œâ”€â”€ RankingBoard.tsx   # æ’è¡Œæ¦œä¸»å…ƒä»¶ï¼ˆå«å½ˆå¥æ¨™è¨˜ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ RankingHeader.tsx  # æ¨™é¡Œå€ï¼ˆæ¥µç°¡ç‰ˆï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ RankingBadge.tsx   # æ’åå¾½ç« 
â”‚   â”‚   â”‚   â””â”€â”€ useRankingData.ts  # æ’è¡Œè³‡æ–™ Hook
â”‚   â”‚   â”œâ”€â”€ SongList/
â”‚   â”‚   â”‚   â”œâ”€â”€ SongList.tsx       # æ­Œæ›²åˆ—è¡¨ï¼ˆå«è‡ªå‹•è¼‰å…¥ï¼‰
â”‚   â”‚   â”‚   â””â”€â”€ VirtualSongList.tsx # è™›æ“¬æ»¾å‹•åˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ SearchBar.tsx          # æœå°‹æ¬„ï¼ˆç²¾ç°¡ç‰ˆï¼‰
â”‚   â”‚   â””â”€â”€ ScrollToTop.tsx        # è¿”å›é ‚éƒ¨æŒ‰éˆ•
â”‚   â””â”€â”€ pages/
â”‚       â””â”€â”€ Home.tsx               # ä¸»é é¢
â”œâ”€â”€ firestore.rules                # Firestore å®‰å…¨è¦å‰‡ï¼ˆå« playedSongsï¼‰
â””â”€â”€ package.json
```

---

## ğŸ”§ é–‹ç™¼ç’°å¢ƒæŒ‡ä»¤

```bash
# å•Ÿå‹•æœ¬åœ°é–‹ç™¼ä¼ºæœå™¨
npm run dev
# è¨ªå• http://localhost:5173/song/

# TypeScript é¡å‹æª¢æŸ¥
npm run check

# éƒ¨ç½² Firestore è¦å‰‡
firebase deploy --only firestore:rules --project guitar-ff931
```

---

## ğŸ“ ä¸‹æ¬¡å¯ç¹¼çºŒçš„æ–¹å‘

1. **åŠŸèƒ½æ¸¬è©¦**ï¼šæ¸¬è©¦ç®¡ç†å“¡å½ˆå¥æ¨™è¨˜çš„å®Œæ•´æµç¨‹
2. **æ‰‹æ©Ÿæ¸¬è©¦**ï¼šç¢ºèªéŸ¿æ‡‰å¼ä½ˆå±€åœ¨æ‰‹æ©Ÿä¸Šçš„æ•ˆæœ
3. **æ•ˆèƒ½å„ªåŒ–**ï¼šæª¢æŸ¥è¤‡é›œå‹•ç•«å°æ‰‹æ©Ÿæ•ˆèƒ½çš„å½±éŸ¿
4. **æ–°åŠŸèƒ½é–‹ç™¼**ï¼šæ ¹æ“šä½¿ç”¨è€…å›é¥‹æ–°å¢åŠŸèƒ½

---

## âš ï¸ æ³¨æ„äº‹é …

- Firebase å°ˆæ¡ˆ IDï¼š`guitar-ff931`
- æ‰€æœ‰ Firestore è¦å‰‡å·²éƒ¨ç½²
- TypeScript ç·¨è­¯å·²é€šé
- é–‹ç™¼ä¼ºæœå™¨ URLï¼š`http://localhost:5173/song/`

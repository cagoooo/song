generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        Int      @id @default(autoincrement())
  username  String   @unique
  password  String
  isAdmin   Boolean  @default(false)
  createdAt DateTime @default(now()) @map("created_at")
  songs     Song[]

  @@map("users")
}

model Song {
  id          Int       @id @default(autoincrement())
  title       String
  artist      String
  key         String?
  notes       String?
  lyrics      String?
  audioUrl    String?   @map("audio_url")
  createdAt   DateTime  @default(now()) @map("created_at")
  createdBy   Int?      @map("created_by")
  isActive    Boolean   @default(true) @map("is_active")
  creator     User?     @relation(fields: [createdBy], references: [id])
  votes       Vote[]
  songTags    SongTag[]
  qrCodeScans QRCodeScan[]

  @@map("songs")
}

model Vote {
  id        Int      @id @default(autoincrement())
  songId    Int      @map("song_id")
  sessionId String   @map("session_id")
  createdAt DateTime @default(now()) @map("created_at")
  song      Song     @relation(fields: [songId], references: [id])

  @@map("votes")
}

model Tag {
  id        Int       @id @default(autoincrement())
  name      String    @unique
  createdAt DateTime  @default(now()) @map("created_at")
  songTags  SongTag[]

  @@map("tags")
}

model SongTag {
  id        Int      @id @default(autoincrement())
  songId    Int      @map("song_id")
  tagId     Int      @map("tag_id")
  createdAt DateTime @default(now()) @map("created_at")
  song      Song     @relation(fields: [songId], references: [id])
  tag       Tag      @relation(fields: [tagId], references: [id])

  @@map("song_tags")
}

model SongSuggestion {
  id          Int      @id @default(autoincrement())
  title       String
  artist      String
  suggestedBy String?  @map("suggested_by")
  status      String   @default("pending")
  createdAt   DateTime @default(now()) @map("created_at")
  notes       String?

  @@map("song_suggestions")
}

model QRCodeScan {
  id        Int      @id @default(autoincrement())
  songId    Int      @map("song_id")
  sessionId String   @map("session_id")
  userAgent String?  @map("user_agent")
  referrer  String?
  createdAt DateTime @default(now()) @map("created_at")
  song      Song     @relation(fields: [songId], references: [id])

  @@map("qr_code_scans")
}
